{
  "variables": [],
  "info": {
    "name": "BasketServiceContractTest",
    "_postman_id": "92e90eaf-944d-ecf4-0b88-4ff9bad23764",
    "description": "",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "86000aba-fe93-dcd3-d305-4b4b0d83e867",
      "name": "1. Setup",
      "description": "",
      "item": [
        {
          "_postman_id": "5c7cec89-ced6-8db2-24f2-8f9f7cf6c3ee",
          "name": "Livecheck and Setup",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;"
                ]
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var guid = (function() {",
                  "  function s4() {",
                  "    return Math.floor((1 + Math.random()) * 0x10000)",
                  "               .toString(16)",
                  "               .substring(1);",
                  "  }",
                  "  return function() {",
                  "    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +",
                  "           s4() + '-' + s4() + s4() + s4();",
                  "  };",
                  "})();",
                  "",
                  "var projectDefId = guid();",
                  "//var projectDefId = \"PostmanProject12345\";",
                  "postman.setEnvironmentVariable(\"projectId\", projectDefId);",
                  "postman.setEnvironmentVariable(\"defId\", projectDefId);",
                  "",
                  "var basketId = guid();",
                  "//var basketId = \"PostmanBasket12345\";",
                  "postman.setEnvironmentVariable(\"basketId\", basketId);"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": "{{host}}/livecheck",
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "c16ff0c9-7ea3-23a3-7dda-c08e38601cd3",
          "name": "Create Project",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;",
                  "",
                  "var jsonData = JSON.parse(responseBody);",
                  "tests[\"Project posted correctly\"] = jsonData.id = environment.projectId;",
                  "",
                  "postman.setEnvironmentVariable(\"projectLastModified\", new Date(jsonData.lastModified).toUTCString());",
                  "postman.setEnvironmentVariable(\"projectMPId\", jsonData.merchandisingProductId);",
                  ""
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept-Language",
                "value": "{{localization}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{projectId}}\",\n  \"merchandisingProductId\": \"MP-211661\",\n  \"documentSource\": {\n    \"sourceType\": \"document\",\n    \"data\": \"2JM58-2A066-8O7\"\n  },\n  \"accessories\": [ ],\n  \"flowState\": \"ProductFirstFlow\",\n  \"quantitiesByVariantAttributeChoices\": \n  [\n    {\n      \"quantity\": 2,\n      \"variantAttributeChoices\": {\n        \"ShirtColor\": \"20631\",\n        \"ShirtSize\": \"212290\"\n      }\n    },\n    {\n      \"quantity\": 3,\n      \"variantAttributeChoices\": {\n        \"ShirtColor\": \"20631\",\n        \"ShirtSize\": \"212286\"\n      }\n    }\n  ]\n}"
            },
            "url": "{{projectServiceUrl}}/v5",
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "d8c78d07-afb5-d4e7-1ee1-4ad77d546a78",
          "name": "Add Project to Basket",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n  \"id\": \"{{projectId}}\",\r\n  \"environment\": \"prod\",\r\n  \"version\": \"4\"\r\n}"
            },
            "url": "{{host}}/basket/{{basketId}}/defs/{{projectId}}/projectref",
            "description": ""
          },
          "response": []
        }
      ]
    },
    {
      "_postman_id": "86f117bc-40ae-732d-99e9-e24fc15288e2",
      "name": "2. Contract Checks",
      "description": "",
      "item": [
        {
          "_postman_id": "18aaf482-795b-83a0-06c2-7e805ef09e3c",
          "name": "GetBasket",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var baskets = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Baskets\",",
                  "    \"type\": \"array\",",
                  "    \"items\":{",
                  "        \"properties\": {",
                  "            \"basketId\": {",
                  "                \"type\": \"string\"",
                  "            },",
                  "            \"definitionId\":{",
                  "                \"type\": \"string\"",
                  "            },",
                  "            \"definitionType\":{",
                  "                \"type\": \"string\"",
                  "            },",
                  "            \"definitionLastModifiedDate\":{",
                  "                \"type\": \"string\"",
                  "            },",
                  "            \"definition\": {",
                  "                \"type\":\"object\"",
                  "            }",
                  "        },",
                  "        \"required\": [\"basketId\",\"definitionId\",\"definitionType\",\"definitionLastModifiedDate\",\"definition\"]",
                  "    }",
                  "}",
                  "",
                  "var message = \"Response fulfills GetBasket Contract\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(baskets);",
                  "}",
                  "",
                  "tests[message] = validationResult;"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": "{{host}}/basket/{{basketId}}",
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "53fdf08e-5b9b-52cd-be0b-e1fbe13c46dd",
          "name": "GetBasketItemsAllAnnotations",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var baskets = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Itemized Basket\",",
                  "    \"type\": \"object\",",
                  "    \"properties\": {",
                  "        \"basketId\": {",
                  "            \"type\":\"string\"",
                  "        },",
                  "        \"itemGroups\":{",
                  "            \"type\": \"array\",",
                  "            \"minItems\":1,",
                  "            \"items\":{",
                  "                \"properties\": {",
                  "                    \"items\":{",
                  "                        \"type\":\"array\",",
                  "                        \"minItems\":1,",
                  "                        \"items\":{",
                  "                            \"properties\": {",
                  "                                \"sku\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"role\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"quantity\":{",
                  "                                    \"type\":\"integer\"",
                  "                                },",
                  "                                \"merchandisingProductId\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"itemKey\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"documentSource\": {",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"sourceType\": {",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"data\": {",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"sourceType\",\"data\"]",
                  "                                },",
                  "                                \"documentId\": {",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"localization\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"SkuDisplayName\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"MerchantProductDisplayName\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"Language\":{",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"SkuDisplayName\",\"MerchantProductDisplayName\",\"Language\"]",
                  "                                },",
                  "                                \"peep\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\":{",
                  "                                        \"projectId\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"selectionId\":{",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"projectId\", \"selectionId\"]",
                  "                                },",
                  "                                \"shipping\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\":{",
                  "                                        \"itemKey\":\"string\"",
                  "                                    },",
                  "                                    \"required\":[\"itemKey\"]",
                  "                                }",
                  "                            },",
                  "                            \"required\":[\"sku\",\"role\",\"quantity\",\"merchandisingProductId\",\"itemKey\",\"documentSource\",\"documentId\",\"localization\",\"peep\",\"shipping\"]",
                  "                        }",
                  "                    },",
                  "                    \"definitionId\": {",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definitionType\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definition\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"id\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"environment\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"version\":{",
                  "                                \"type\":\"string\"",
                  "                            }",
                  "                        },",
                  "                        \"required\":[\"id\"]",
                  "                    },",
                  "                    \"itemsLastModifiedDate\":{",
                  "                        \"type\":[\"string\"]",
                  "                    },",
                  "                    \"peep\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"projectId\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"required\":[\"projectId\"]",
                  "                        }",
                  "                    },",
                  "                },",
                  "                \"required\":[\"items\", \"definitionId\", \"definitionType\",\"definition\",\"itemsLastModifiedDate\",\"peep\"]",
                  "            }",
                  "        }",
                  "    },",
                  "    \"required\":[\"basketId\"]",
                  "};",
                  "",
                  "var message = \"Response fulfills Get Basket Itemization Contract (all annotations)\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(baskets);",
                  "}",
                  "",
                  "tests[message] = validationResult; "
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{host}}/basket/{{basketId}}/items?ann=*",
              "host": [
                "{{host}}"
              ],
              "path": [
                "basket",
                "{{basketId}}",
                "items"
              ],
              "query": [
                {
                  "equals": true,
                  "key": "ann",
                  "value": "*"
                }
              ]
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "7d6457e6-a024-6754-ce50-f930db98ccda",
          "name": "GetBasketItemsWithLocalizationAnnotation",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var baskets = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Itemized Basket\",",
                  "    \"type\": \"object\",",
                  "    \"properties\": {",
                  "        \"basketId\": {",
                  "            \"type\":\"string\"",
                  "        },",
                  "        \"itemGroups\":{",
                  "            \"type\": \"array\",",
                  "            \"minItems\":1,",
                  "            \"items\":{",
                  "                \"properties\": {",
                  "                    \"items\":{",
                  "                        \"type\":\"array\",",
                  "                        \"minItems\":1,",
                  "                        \"items\":{",
                  "                            \"properties\": {",
                  "                                \"sku\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"role\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"quantity\":{",
                  "                                    \"type\":\"integer\"",
                  "                                },",
                  "                                \"merchandisingProductId\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"itemKey\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"documentSource\": {",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"sourceType\": {",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"data\": {",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"sourceType\",\"data\"]",
                  "                                },",
                  "                                \"documentId\": {",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"localization\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"SkuDisplayName\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"MerchantProductDisplayName\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"Language\":{",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"SkuDisplayName\",\"MerchantProductDisplayName\",\"Language\"]",
                  "                                }",
                  "                            },",
                  "                            \"required\":[\"sku\",\"role\",\"quantity\",\"merchandisingProductId\",\"itemKey\",\"documentSource\",\"localization\",\"documentId\"]",
                  "                        }",
                  "                    },",
                  "                    \"definitionId\": {",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definitionType\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definition\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"id\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"environment\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"version\":{",
                  "                                \"type\":\"string\"",
                  "                            }",
                  "                        },",
                  "                        \"required\":[\"id\"]",
                  "                    },",
                  "                    \"itemsLastModifiedDate\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                },",
                  "                \"required\":[\"items\", \"definitionId\", \"definitionType\",\"definition\",\"itemsLastModifiedDate\"]",
                  "            }",
                  "        }",
                  "    },",
                  "    \"required\":[\"basketId\"]",
                  "};",
                  "",
                  "var message = \"Response fulfills Get Basket Itemization Contract (localization annotation)\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(baskets);",
                  "}",
                  "tests[message] = validationResult; "
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{host}}/basket/{{basketId}}/items?ann=localization",
              "host": [
                "{{host}}"
              ],
              "path": [
                "basket",
                "{{basketId}}",
                "items"
              ],
              "query": [
                {
                  "equals": true,
                  "key": "ann",
                  "value": "localization"
                }
              ]
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "1efbb8bf-7d2a-0b3c-3a27-e574946eb49a",
          "name": "GetBasketItemsWithShippingAnnotation",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var baskets = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Itemized Basket\",",
                  "    \"type\": \"object\",",
                  "    \"properties\": {",
                  "        \"basketId\": {",
                  "            \"type\":\"string\"",
                  "        },",
                  "        \"itemGroups\":{",
                  "            \"type\": \"array\",",
                  "            \"minItems\":1,",
                  "            \"items\":{",
                  "                \"properties\": {",
                  "                    \"items\":{",
                  "                        \"type\":\"array\",",
                  "                        \"minItems\":1,",
                  "                        \"items\":{",
                  "                            \"properties\": {",
                  "                                \"sku\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"role\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"quantity\":{",
                  "                                    \"type\":\"integer\"",
                  "                                },",
                  "                                \"merchandisingProductId\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"itemKey\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"documentSource\": {",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"sourceType\": {",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"data\": {",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"sourceType\",\"data\"]",
                  "                                },",
                  "                                \"documentId\": {",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"shipping\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\":{",
                  "                                        \"itemKey\":\"string\"",
                  "                                    },",
                  "                                    \"required\":[\"itemKey\"]",
                  "                                }",
                  "                            },",
                  "                            \"required\":[\"sku\",\"role\",\"quantity\",\"merchandisingProductId\",\"itemKey\",\"documentSource\",\"documentId\",\"shipping\"]",
                  "                        }",
                  "                    },",
                  "                    \"definitionId\": {",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definitionType\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definition\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"id\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"environment\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"version\":{",
                  "                                \"type\":\"string\"",
                  "                            }",
                  "                        },",
                  "                        \"required\":[\"id\"]",
                  "                    },",
                  "                    \"itemsLastModifiedDate\":{",
                  "                        \"type\":\"string\"",
                  "                    }",
                  "                },",
                  "                \"required\":[\"items\", \"definitionId\", \"definitionType\",\"definition\",\"itemsLastModifiedDate\"]",
                  "            }",
                  "        }",
                  "    },",
                  "    \"required\":[\"basketId\"]",
                  "};",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "}",
                  "",
                  "var message = \"Response fulfills Get Basket Itemization Contract (shipping annotation)\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(baskets);",
                  "}",
                  "",
                  "tests[message] = validationResult; "
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{host}}/basket/{{basketId}}/items?ann=shipping",
              "host": [
                "{{host}}"
              ],
              "path": [
                "basket",
                "{{basketId}}",
                "items"
              ],
              "query": [
                {
                  "equals": true,
                  "key": "ann",
                  "value": "shipping"
                }
              ]
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "5a425241-d39a-664c-6af5-2764bc673d28",
          "name": "GetBasketItemsWithPeepAnnotation",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var baskets = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Itemized Basket\",",
                  "    \"type\": \"object\",",
                  "    \"properties\": {",
                  "        \"basketId\": {",
                  "            \"type\":\"string\"",
                  "        },",
                  "        \"itemGroups\":{",
                  "            \"type\": \"array\",",
                  "            \"minItems\":1,",
                  "            \"items\":{",
                  "                \"properties\": {",
                  "                    \"items\":{",
                  "                        \"type\":\"array\",",
                  "                        \"minItems\":1,",
                  "                        \"items\":{",
                  "                            \"properties\": {",
                  "                                \"sku\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"role\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"quantity\":{",
                  "                                    \"type\":\"integer\"",
                  "                                },",
                  "                                \"merchandisingProductId\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"itemKey\":{",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"documentSource\": {",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\": {",
                  "                                        \"sourceType\": {",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"data\": {",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"sourceType\",\"data\"]",
                  "                                },",
                  "                                \"documentId\": {",
                  "                                    \"type\":\"string\"",
                  "                                },",
                  "                                \"peep\":{",
                  "                                    \"type\":\"object\",",
                  "                                    \"properties\":{",
                  "                                        \"projectId\":{",
                  "                                            \"type\":\"string\"",
                  "                                        },",
                  "                                        \"selectionId\":{",
                  "                                            \"type\":\"string\"",
                  "                                        }",
                  "                                    },",
                  "                                    \"required\":[\"projectId\", \"selectionId\"]",
                  "                                }",
                  "                            },",
                  "                            \"required\":[\"sku\",\"role\",\"quantity\",\"merchandisingProductId\",\"itemKey\",\"documentSource\",\"documentId\",\"peep\"]",
                  "                        }",
                  "                    },",
                  "                    \"definitionId\": {",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definitionType\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"definition\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"id\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"environment\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"version\":{",
                  "                                \"type\":\"string\"",
                  "                            }",
                  "                        },",
                  "                        \"required\":[\"id\"]",
                  "                    },",
                  "                    \"itemsLastModifiedDate\":{",
                  "                        \"type\":\"string\"",
                  "                    },",
                  "                    \"peep\":{",
                  "                        \"type\":\"object\",",
                  "                        \"properties\":{",
                  "                            \"projectId\":{",
                  "                                \"type\":\"string\"",
                  "                            },",
                  "                            \"required\":[\"projectId\"]",
                  "                        }",
                  "                    },",
                  "                },",
                  "                \"required\":[\"items\", \"definitionId\", \"definitionType\",\"definition\",\"itemsLastModifiedDate\",\"peep\"]",
                  "            }",
                  "        }",
                  "    },",
                  "    \"required\":[\"basketId\"]",
                  "};",
                  "",
                  "",
                  "var message = \"Response fulfills Get Basket Itemization Contract (peep annotation)\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(baskets, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(baskets);",
                  "}",
                  "",
                  "tests[message] = validationResult; "
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": {
              "raw": "{{host}}/basket/{{basketId}}/items?ann=peep",
              "host": [
                "{{host}}"
              ],
              "path": [
                "basket",
                "{{basketId}}",
                "items"
              ],
              "query": [
                {
                  "equals": true,
                  "key": "ann",
                  "value": "peep"
                }
              ]
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "7dc915a1-850e-f8d7-bc04-75e38c260450",
          "name": "GetBasketDefinition",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "var basket = JSON.parse(responseBody);",
                  "",
                  "var schema = {",
                  "    \"title\": \"Project Reference\",",
                  "    \"type\": \"object\",",
                  "    \"properties\": {",
                  "        \"id\": {",
                  "            \"type\":\"string\"",
                  "        },",
                  "        \"environment\":{",
                  "            \"type\": \"string\"",
                  "        },",
                  "        \"version\":{",
                  "            \"type\": \"string\"",
                  "        }",
                  "    },",
                  "    \"required\":[\"id\"]",
                  "}",
                  "",
                  "var message = \"Test Project Reference Definition\";",
                  "",
                  "tv4.setErrorReporter(function (error, data, schema) {",
                  "    var errorMessage = \" \";",
                  "    console.log(data);",
                  "    console.log(schema);",
                  "    if(error)",
                  "        errorMessage += error;",
                  "        ",
                  "    if(error.dataPath)",
                  "        errorMessage += \" DataPath: \" + error.dataPath;",
                  "        ",
                  "    if(error.schemaPath)",
                  "        errorMessage += \" SchemaPath: \" + error.schemaPath;",
                  "        ",
                  "    if(schema)",
                  "        errorMessage += \" RequiredFields: \" + schema.required;",
                  "    ",
                  "    return errorMessage;",
                  "});",
                  "",
                  "var validationResult = tv4.validate(basket, schema);",
                  "",
                  "if(tv4.error) {",
                  "    console.log(\"Validation failure\", tv4.error);",
                  "    message += \":Failure Reason: \" + tv4.error.message;",
                  "    message += \" BASKET RESPONSE: \" + JSON.stringify(basket);",
                  "}",
                  "",
                  "tests[message] = validationResult; ",
                  "",
                  ""
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": "{{host}}/basket/{{basketId}}/defs/{{defId}}/projectref",
            "description": ""
          },
          "response": []
        }
      ]
    },
    {
      "_postman_id": "fba320db-4ad1-8999-c66f-53b85305ef14",
      "name": "3. Cleanup",
      "description": "",
      "item": [
        {
          "_postman_id": "ad9cdbaa-8cda-9ad4-9be1-9d2f0807e6f5",
          "name": "Delete Entire Basket",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;"
                ]
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Accept-Language",
                "value": "{{localization}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "url": "{{host}}/basket/{{basketId}}",
            "description": ""
          },
          "response": []
        }
      ]
    }
  ]
}